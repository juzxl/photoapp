<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhotoApp - Главная</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/fonts.css">
    <style>
        /* Тёмные кнопки вместо синих */
        .btn-primary {
            background-color: #212529;
            border-color: #212529;
        }
        .btn-primary:hover, .btn-primary:focus, .btn-primary:active {
            background-color: #000 !important;
            border-color: #000 !important;
        }
        .btn-outline-primary {
            color: #212529;
            border-color: #212529;
        }
        .btn-outline-primary:hover, .btn-outline-primary:focus, .btn-outline-primary:active {
            background-color: #212529 !important;
            border-color: #212529 !important;
            color: #fff !important;
        }
    </style>
</head>
<body>
    <!-- Навигационная панель -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">PhotoApp</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="/">Главная</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/gallery">Галерея</a>
                    </li>
                    <li class="nav-item user-links" style="display:none;">
                        <a class="nav-link" href="/albums">Мои альбомы</a>
                    </li>
                    <li class="nav-item user-links" style="display:none;">
                        <a class="nav-link" href="/upload">Загрузить</a>
                    </li>
                    <li class="nav-item user-links" style="display:none;">
                        <a class="nav-link" href="/favorites">Избранное</a>
                    </li>
                </ul>
                <!-- Поиск -->
                <form class="d-flex me-3" id="searchForm">
                    <input class="form-control me-2" type="search" placeholder="Поиск" id="searchInput">
                    <button class="btn btn-outline-light" type="submit">Поиск</button>
                </form>
                <!-- Кнопки авторизации -->
                <div class="guest-links">
                    <a href="/login.html" class="btn btn-outline-light me-2">Войти</a>
                    <a href="/register.html" class="btn btn-primary">Регистрация</a>
                </div>
                <!-- Меню пользователя -->
                <div class="user-links" style="display:none;">
                    <div class="dropdown">
                        <button class="btn btn-light dropdown-toggle" type="button" id="userMenuButton" data-bs-toggle="dropdown">
                            <i class="fas fa-user"></i>
                            <span class="username-display">Пользователь</span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="/profile">Профиль</a></li>
                            <li><a class="dropdown-item" href="/settings">Настройки</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" id="logoutBtn">Выйти</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Основной контент -->
    <div class="container mt-4">
        <!-- Welcome section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="welcome-section p-4 bg-light rounded shadow-sm">
                    <h2>Добро пожаловать в PhotoApp!</h2>
                    <p class="lead">Платформа для любителей фотографии, где вы можете делиться своими снимками, создавать коллекции и находить вдохновение.</p>
                    <div class="guest-links mt-3">
                        <a href="/register.html" class="btn btn-primary me-2">Зарегистрироваться</a>
                        <a href="/login.html" class="btn btn-outline-dark">Войти</a>
                    </div>
                    <div class="user-links mt-3" style="display:none;">
                        <a href="/upload" class="btn btn-primary me-2"><i class="fas fa-upload"></i> Загрузить фото</a>
                        <a href="/albums" class="btn btn-outline-dark me-2"><i class="fas fa-book"></i> Мои альбомы</a>
                        <a href="/profile" class="btn btn-outline-dark"><i class="fas fa-user"></i> Мои фотографии</a>
                    </div>
                    <div class="admin-links mt-3" style="display:none;">
                        <a href="/admin/users.html" class="btn btn-danger"><i class="fas fa-tools"></i> Панель администратора</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Фильтры и теги -->
        <div class="row mb-4">
            <div class="col-md-8">
                <div class="tags-container">
                    <h5>Популярные теги:</h5>
                    <div class="popular-tags" id="popularTags">
                        <!-- Теги будут добавлены через JavaScript -->
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="filters">
                    <select class="form-select" id="sortFilter">
                        <option value="recent">Сначала новые</option>
                        <option value="popular">По популярности</option>
                        <option value="rating">По рейтингу</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Галерея фотографий -->
        <div class="row" id="photoGallery">
            <!-- Фотографии будут добавлены через JavaScript -->
        </div>

        <!-- Пагинация -->
        <nav aria-label="Навигация по страницам" class="mt-4">
            <ul class="pagination justify-content-center" id="pagination">
                <!-- Пагинация будет добавлена через JavaScript -->
            </ul>
        </nav>
    </div>

    <!-- Модальное окно для просмотра фотографии -->
    <div class="modal fade photo-modal" id="photoModal" tabindex="-1" aria-labelledby="photoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header border-0 pb-0">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="row g-0">
                        <div class="col-md-8 d-flex align-items-center justify-content-center bg-light">
                            <div class="modal-image-container">
                                <img id="modalPhoto" src="" class="modal-image" alt="Фотография">
                            </div>
                        </div>
                        <div class="col-md-4 modal-sidebar">
                            <div class="d-flex justify-content-between align-items-start">
                                <h5 class="modal-title mb-3" id="photoModalLabel">Название фотографии</h5>
                                <div class="dropdown photo-owner-actions" style="display:none;">
                                    <button class="btn btn-sm btn-outline-secondary" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#" id="editPhotoBtn"><i class="fas fa-edit me-2"></i>Редактировать</a></li>
                                        <li><hr class="dropdown-divider"></li>
                                        <li><a class="dropdown-item text-danger" href="#" id="deletePhotoBtn"><i class="fas fa-trash-alt me-2"></i>Удалить</a></li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <h6 class="fw-bold mb-2">Автор</h6>
                                <p class="mb-0">
                                    <a id="photoAuthor" href="/profile.html" class="author-link">Имя автора</a>
                                </p>
                            </div>
                            
                            <div class="mb-3">
                                <h6 class="fw-bold mb-2">Описание</h6>
                                <p id="photoDescription" class="photo-description mb-0">Описание фотографии</p>
                            </div>
                            
                            <div class="mb-3">
                                <h6 class="fw-bold mb-2">Рейтинг</h6>
                                <p class="mb-0">
                                    <span id="photoRating" class="stars">★★★★★</span>
                                    <span id="ratingCount" class="text-muted">(0 оценок)</span>
                                </p>
                            </div>
                            
                            <div class="mb-3">
                                <h6 class="fw-bold mb-2">Теги</h6>
                                <div id="photoTags" class="photo-tags">
                                    <!-- Теги будут добавлены через JavaScript -->
                                </div>
                            </div>
                            
                            <div class="d-flex mb-4 gap-3 justify-content-center">
                                <button id="shareModalPhoto" class="modal-action-btn share" title="Поделиться">
                                    <i class="fas fa-share-alt"></i>
                                </button>
                                <button id="ratePhoto" class="modal-action-btn rate" title="Оценить">
                                    <i class="fas fa-star"></i>
                                </button>
                                <div class="dropdown photo-options owner-only" style="display:none;">
                                    <button class="modal-action-btn options" title="Управление" data-bs-toggle="dropdown">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#" id="editPhotoBtn"><i class="fas fa-edit me-2"></i>Редактировать фото</a></li>
                                        <li><hr class="dropdown-divider"></li>
                                        <li><a class="dropdown-item text-danger" href="#" id="deletePhotoBtn"><i class="fas fa-trash-alt me-2"></i>Удалить фото</a></li>
                                    </ul>
                                </div>
                                <!-- Новые кнопки для модераторов -->
                                <div class="dropdown" id="moderatorActionsBtn" style="display:none;">
                                    <button class="modal-action-btn options" title="Модерация" data-bs-toggle="dropdown">
                                        <i class="fas fa-shield-alt"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item text-danger" href="#" id="moderatorDeletePhotoBtn"><i class="fas fa-trash-alt me-2"></i>Удалить фото (Модератор)</a></li>
                                    </ul>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <h6 class="fw-bold mb-3">Комментарии</h6>
                            <div id="commentsList" class="comments mb-3">
                                <!-- Комментарии будут добавлены через JavaScript -->
                            </div>
                            
                            <form id="commentForm" class="mt-3 comment-form">
                                <div class="mb-3">
                                    <textarea id="commentText" class="form-control" rows="3" placeholder="Оставьте комментарий..."></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">Отправить</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white mt-5 py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>О проекте</h5>
                    <p>PhotoApp - платформа для обмена фотографиями и создания фотоальбомов.</p>
                </div>
                <div class="col-md-3">
                    <h5>Ссылки</h5>
                    <ul class="list-unstyled">
                        <li><a href="/about.html" class="text-white">О нас</a></li>
                        <li><a href="/terms.html" class="text-white">Условия использования</a></li>
                        <li><a href="/privacy.html" class="text-white">Политика конфиденциальности</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5>Контакты</h5>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-envelope"></i> support@photoapp.com</li>
                        <li><i class="fas fa-phone"></i> +7 (999) 123-45-67</li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/debug.js"></script>
    <script src="/js/db.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/common.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/feed.js"></script>
    <script>
        $(document).ready(function() {
            // Проверяем доступ к защищенной странице
            checkProtectedPage();
            
            // Обновляем UI для авторизованного пользователя
            updateAuthUI();
        });
        $('#logoutBtn').on('click', function(e) {
            e.preventDefault();
            console.log("Logout button clicked in albums.html");

            logout();
        });
    </script>
</body>
</html> 